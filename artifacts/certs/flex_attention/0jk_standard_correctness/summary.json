{
  "args": {
    "artifacts_dir": "artifacts",
    "atol": 0.01,
    "batch_size": 2,
    "compile": true,
    "device": "cuda",
    "dtype": "float32",
    "kv_chunk_len": 7,
    "kv_prefix_len": 13,
    "model": "standard",
    "n_embd": 128,
    "n_head": 4,
    "n_kv_head": 2,
    "n_layer": 2,
    "rtol": 0.001,
    "run_id": "0jk_standard_correctness",
    "seed": 0,
    "sequence_len": 64,
    "suite": true,
    "vocab_size": 1024,
    "write_artifacts": true
  },
  "argv": [
    "scripts/verify_flex_correctness.py",
    "--model",
    "standard",
    "--device",
    "cuda",
    "--dtype",
    "float32",
    "--suite",
    "--compile",
    "--run-id",
    "0jk_standard_correctness"
  ],
  "command": "uv run python scripts/verify_flex_correctness.py --model standard --device cuda --dtype float32 --suite --compile --run-id 0jk_standard_correctness",
  "config": {
    "flex": {
      "attention_type": "standard",
      "n_embd": 128,
      "n_head": 4,
      "n_kv_head": 2,
      "n_layer": 2,
      "optimizer_type": "adamw",
      "sequence_len": 64,
      "use_flex_attention": true,
      "vocab_size": 1024
    },
    "ref": {
      "attention_type": "standard",
      "n_embd": 128,
      "n_head": 4,
      "n_kv_head": 2,
      "n_layer": 2,
      "optimizer_type": "adamw",
      "sequence_len": 64,
      "use_flex_attention": false,
      "vocab_size": 1024
    }
  },
  "device": "cuda",
  "dtype": "float32",
  "git": {
    "branch": "main",
    "commit": "95ab717",
    "commit_full": "95ab717124a53d816acfdc82d21628e443b811df",
    "dirty": true,
    "message": "Comprehensively revise README.md to reflect dual-implementation architecture"
  },
  "gpu": {
    "available": true,
    "count": 2,
    "cuda_version": "12.8",
    "memory_gb": [
      23.5164794921875,
      23.5135498046875
    ],
    "names": [
      "NVIDIA GeForce RTX 4090",
      "NVIDIA GeForce RTX 4090"
    ]
  },
  "python": {
    "executable": "/data/projects/model_guided_research/.venv/bin/python3",
    "version": "3.13.0 (main, Oct 16 2024, 03:23:02) [Clang 18.1.8 ]"
  },
  "results": {
    "checks": [
      {
        "max_abs": 7.152557373046875e-07,
        "max_rel": 0.25,
        "mean_abs": 7.507915711357782e-08,
        "name": "mqa/full_forward",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 4.76837158203125e-07,
        "max_rel": 0.00011621488374657929,
        "mean_abs": 7.1616724994783e-08,
        "name": "mqa/kv_decode_last",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 4.76837158203125e-07,
        "max_rel": 0.0015497406711801887,
        "mean_abs": 7.418987024720991e-08,
        "name": "mqa/kv_chunk_decode",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 5.960464477539062e-07,
        "max_rel": 0.660714328289032,
        "mean_abs": 6.934070739816889e-08,
        "name": "gqa/full_forward",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 3.5762786865234375e-07,
        "max_rel": 0.0060998364351689816,
        "mean_abs": 6.05642895834535e-08,
        "name": "gqa/kv_decode_last",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 5.960464477539062e-07,
        "max_rel": 0.0016980496002361178,
        "mean_abs": 7.324760531446373e-08,
        "name": "gqa/kv_chunk_decode",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 5.960464477539062e-07,
        "max_rel": 0.02364864945411682,
        "mean_abs": 7.872129970110109e-08,
        "name": "mha/full_forward",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 5.364418029785156e-07,
        "max_rel": 0.0001454283483326435,
        "mean_abs": 8.134517770486127e-08,
        "name": "mha/kv_decode_last",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 5.960464477539062e-07,
        "max_rel": 0.005594405811280012,
        "mean_abs": 7.903987153667913e-08,
        "name": "mha/kv_chunk_decode",
        "note": "",
        "passed": true
      }
    ],
    "ok": true
  },
  "system": {
    "cpu_count": 32,
    "cpu_count_logical": 64,
    "hostname": "threadripperje",
    "memory_gb": 499.2872734069824,
    "nanochat_base_dir": "/home/ubuntu/.cache/nanochat",
    "nanochat_base_dir_env": null,
    "platform": "Linux",
    "python_version": "3.13.0",
    "torch_version": "2.9.1+cu128",
    "user": "ubuntu",
    "working_dir": "/data/projects/model_guided_research"
  }
}
