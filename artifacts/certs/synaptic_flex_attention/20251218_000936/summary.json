{
  "args": {
    "artifacts_dir": "artifacts",
    "atol": 0.01,
    "batch_size": 1,
    "compile": true,
    "device": "cuda",
    "dtype": "bfloat16",
    "kv_chunk_len": 7,
    "kv_prefix_len": 13,
    "model": "synaptic",
    "n_embd": 128,
    "n_head": 4,
    "n_kv_head": 2,
    "n_layer": 2,
    "rtol": 0.001,
    "run_id": null,
    "seed": 0,
    "sequence_len": 64,
    "suite": false,
    "vocab_size": 1024,
    "write_artifacts": true
  },
  "argv": [
    "scripts/verify_flex_correctness.py",
    "--model",
    "synaptic",
    "--device",
    "cuda",
    "--dtype",
    "bfloat16",
    "--compile",
    "--batch-size",
    "1",
    "--sequence-len",
    "64",
    "--vocab-size",
    "1024",
    "--n-layer",
    "2",
    "--n-head",
    "4",
    "--n-kv-head",
    "2",
    "--n-embd",
    "128"
  ],
  "command": "uv run python scripts/verify_flex_correctness.py --model synaptic --device cuda --dtype bfloat16 --compile --batch-size 1 --sequence-len 64 --vocab-size 1024 --n-layer 2 --n-head 4 --n-kv-head 2 --n-embd 128",
  "config": {
    "flex": {
      "dropout": 0.0,
      "moe_balance_loss": 0.01,
      "moe_hidden_mult": 4,
      "moe_top_k": 2,
      "n_embd": 128,
      "n_head": 4,
      "n_kv_head": 2,
      "n_layer": 2,
      "num_experts": 8,
      "rope_base": 10000.0,
      "sequence_len": 64,
      "structural_every": 0,
      "syn_cfg": {
        "alpha_c": 0.55,
        "amp_leak": 0.006,
        "amp_load": 0.02,
        "attn_topk": 32,
        "barrier_strength": 0.1,
        "bdnf_scale": 1.0,
        "bdnf_tau": 0.985,
        "camkii_down": 0.02,
        "camkii_thr": 1.0,
        "camkii_up": 0.05,
        "complexin_bias": 0.0,
        "cpx_thresh": 0.55,
        "doc2_gain": 0.08,
        "enabled": true,
        "endo_delay": 3,
        "energy_fill": 0.02,
        "energy_max": 1.0,
        "energy_use": 0.02,
        "epsilon": 1e-06,
        "init_amp": 1.0,
        "init_clamp": 0.6,
        "init_energy": 0.85,
        "init_reserve": 18.0,
        "init_rrp": 6.0,
        "init_snare": 0.7,
        "lambda_loge": 1.0,
        "native_genetics": false,
        "native_metrics": false,
        "native_plasticity": false,
        "native_presyn": false,
        "nsf_recover": 0.08,
        "post_fast_decay": 0.95,
        "post_fast_lr": 0.0015,
        "post_slow_lr": 0.0005,
        "post_trace_decay": 0.96,
        "pp1_tau": 0.985,
        "pp1_thr": 0.7,
        "prime_rate": 0.075,
        "rank_eligibility": 8,
        "rec_rate": 0.06,
        "router_contrastive_lr": 0.0001,
        "router_contrastive_push": 0.1,
        "router_embed_dim": 24,
        "router_sim_threshold": 0.6,
        "stochastic_train_frac": 0.0,
        "structural_age_bias": 1.0,
        "structural_interval": 50000,
        "structural_tau_util": 0.2,
        "syt1_slope": 8.0,
        "syt7_slope": 3.0,
        "tau_c": 0.85,
        "unprime_per_release": 0.05,
        "use_flex_attention": true,
        "xi_dim": 4
      },
      "synapses": true,
      "use_moe": false,
      "vocab_size": 1024
    },
    "ref": {
      "dropout": 0.0,
      "moe_balance_loss": 0.01,
      "moe_hidden_mult": 4,
      "moe_top_k": 2,
      "n_embd": 128,
      "n_head": 4,
      "n_kv_head": 2,
      "n_layer": 2,
      "num_experts": 8,
      "rope_base": 10000.0,
      "sequence_len": 64,
      "structural_every": 0,
      "syn_cfg": {
        "alpha_c": 0.55,
        "amp_leak": 0.006,
        "amp_load": 0.02,
        "attn_topk": 32,
        "barrier_strength": 0.1,
        "bdnf_scale": 1.0,
        "bdnf_tau": 0.985,
        "camkii_down": 0.02,
        "camkii_thr": 1.0,
        "camkii_up": 0.05,
        "complexin_bias": 0.0,
        "cpx_thresh": 0.55,
        "doc2_gain": 0.08,
        "enabled": true,
        "endo_delay": 3,
        "energy_fill": 0.02,
        "energy_max": 1.0,
        "energy_use": 0.02,
        "epsilon": 1e-06,
        "init_amp": 1.0,
        "init_clamp": 0.6,
        "init_energy": 0.85,
        "init_reserve": 18.0,
        "init_rrp": 6.0,
        "init_snare": 0.7,
        "lambda_loge": 1.0,
        "native_genetics": false,
        "native_metrics": false,
        "native_plasticity": false,
        "native_presyn": false,
        "nsf_recover": 0.08,
        "post_fast_decay": 0.95,
        "post_fast_lr": 0.0015,
        "post_slow_lr": 0.0005,
        "post_trace_decay": 0.96,
        "pp1_tau": 0.985,
        "pp1_thr": 0.7,
        "prime_rate": 0.075,
        "rank_eligibility": 8,
        "rec_rate": 0.06,
        "router_contrastive_lr": 0.0001,
        "router_contrastive_push": 0.1,
        "router_embed_dim": 24,
        "router_sim_threshold": 0.6,
        "stochastic_train_frac": 0.0,
        "structural_age_bias": 1.0,
        "structural_interval": 50000,
        "structural_tau_util": 0.2,
        "syt1_slope": 8.0,
        "syt7_slope": 3.0,
        "tau_c": 0.85,
        "unprime_per_release": 0.05,
        "use_flex_attention": false,
        "xi_dim": 4
      },
      "synapses": true,
      "use_moe": false,
      "vocab_size": 1024
    }
  },
  "device": "cuda",
  "dtype": "bfloat16",
  "git": {
    "branch": "main",
    "commit": "95ab717",
    "commit_full": "95ab717124a53d816acfdc82d21628e443b811df",
    "dirty": true,
    "message": "Comprehensively revise README.md to reflect dual-implementation architecture"
  },
  "gpu": {
    "available": true,
    "count": 2,
    "cuda_version": "12.8",
    "memory_gb": [
      23.5164794921875,
      23.5135498046875
    ],
    "names": [
      "NVIDIA GeForce RTX 4090",
      "NVIDIA GeForce RTX 4090"
    ]
  },
  "python": {
    "executable": "/data/projects/model_guided_research/.venv/bin/python3",
    "version": "3.13.0 (main, Oct 16 2024, 03:23:02) [Clang 18.1.8 ]"
  },
  "results": {
    "checks": [
      {
        "max_abs": 0.00390625,
        "max_rel": 2085.571533203125,
        "mean_abs": 0.0003768606693483889,
        "name": "synaptic/full_forward",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 0.00390625,
        "max_rel": 3.6521739959716797,
        "mean_abs": 0.0005968436598777771,
        "name": "synaptic/kv_decode_last",
        "note": "",
        "passed": true
      },
      {
        "max_abs": 0.005859375,
        "max_rel": 21.037734985351562,
        "mean_abs": 0.0008307899115607142,
        "name": "synaptic/kv_chunk_decode",
        "note": "",
        "passed": true
      }
    ],
    "ok": true
  },
  "system": {
    "cpu_count": 32,
    "cpu_count_logical": 64,
    "hostname": "threadripperje",
    "memory_gb": 499.2872734069824,
    "nanochat_base_dir": "/home/ubuntu/.cache/nanochat",
    "nanochat_base_dir_env": null,
    "platform": "Linux",
    "python_version": "3.13.0",
    "torch_version": "2.9.1+cu128",
    "user": "ubuntu",
    "working_dir": "/data/projects/model_guided_research"
  }
}
